# XACML Build Process

This document describes the build process for transforming ALFA-compiled XACML files.

## Overview

The build process takes XACML files generated by the ALFA compiler from the `src-gen` directory and transforms them into clean, formatted XACML files in the `build` directory.

## Transformations Applied

1. **Namespace Cleanup**: Removes the `xacml3:` namespace prefix and replaces it with the default XACML namespace
2. **XML Formatting**: Adds proper indentation and line breaks for better readability
3. **File Organization**: Copies transformed files to a clean build directory

## Usage

### Build Command

```bash
npm run build:xacml
```

### Directory Structure

```
├── src-gen/           # ALFA-compiled XACML files (input)
│   └── *.xml
├── build/            # Transformed XACML files (output)
│   └── *.xml
└── scripts/
    └── build-xacml.js # Build script
```

### Example Transformation

**Before** (from `src-gen/`):
```xml
<xacml3:PolicySet xmlns:xacml3="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" PolicyCombiningAlgId="..."><xacml3:Description>...</xacml3:Description></xacml3:PolicySet>
```

**After** (in `build/`):
```xml
<PolicySet xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" PolicyCombiningAlgId="...">
  <Description>
    ...
  </Description>
</PolicySet>
```

## Build Script Features

- ✅ **Automatic Directory Management**: Creates and cleans the build directory
- ✅ **Namespace Transformation**: Removes `xacml3:` prefixes and declarations
- ✅ **XML Formatting**: Adds proper indentation for readability
- ✅ **Error Handling**: Provides clear error messages and status reporting
- ✅ **Multi-file Support**: Processes all XML files in the src-gen directory

## Integration

The build script can be integrated into your development workflow:

```bash
# After compiling ALFA files
npm run build:xacml

# Use the clean XACML files from build/ directory
# for deployment or testing
```

## Files

- `scripts/build-xacml.js` - Main build script
- `package.json` - Contains the `build:xacml` npm script
- `.gitignore` - Excludes `build/` and `src-gen/` directories

## Notes

- The `build/` directory is automatically cleaned on each build
- Source files in `src-gen/` are never modified
- All XML files in `src-gen/` are processed automatically
- The build process preserves the original filename structure